{"ast":null,"code":"var _jsxFileName = \"D:\\\\React_JS\\\\React_JS\\\\react-scripts_JS\\\\src\\\\contexts\\\\JWTContext.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types'; // utils\n\nimport axios from '../utils/axios';\nimport { isValidToken, setSession } from '../utils/jwt'; // ----------------------------------------------------------------------\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  isAuthenticated: false,\n  isInitialized: false,\n  user: null\n};\nconst handlers = {\n  INITIALIZE: (state, action) => {\n    const {\n      isAuthenticated,\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated,\n      isInitialized: true,\n      user\n    };\n  },\n  LOGIN: (state, action) => {\n    const {\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated: true,\n      user\n    };\n  },\n  LOGOUT: state => ({ ...state,\n    isAuthenticated: false,\n    user: null\n  }),\n  REGISTER: (state, action) => {\n    const {\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated: true,\n      user\n    };\n  }\n};\n\nconst reducer = (state, action) => handlers[action.type] ? handlers[action.type](state, action) : state;\n\nconst AuthContext = /*#__PURE__*/createContext({ ...initialState,\n  method: 'jwt',\n  login: () => Promise.resolve(),\n  logout: () => Promise.resolve(),\n  register: () => Promise.resolve()\n}); // ----------------------------------------------------------------------\n\nAuthProvider.propTypes = {\n  children: PropTypes.node\n};\n\nfunction AuthProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [state, dispatch] = useReducer(reducer, initialState);\n  useEffect(() => {\n    const initialize = async () => {\n      try {\n        const accessToken = window.localStorage.getItem('accessToken');\n\n        if (accessToken && isValidToken(accessToken)) {\n          setSession(accessToken);\n          const response = await axios.get('/api/account/my-account');\n          const {\n            user\n          } = response.data;\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: true,\n              user\n            }\n          });\n        } else {\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: false,\n              user: null\n            }\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: 'INITIALIZE',\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    };\n\n    initialize();\n  }, []);\n\n  const login = async (email, password) => {\n    const response = await axios.post('/api/account/login', {\n      email,\n      password\n    });\n    const {\n      accessToken,\n      user\n    } = response.data;\n    setSession(accessToken);\n    dispatch({\n      type: 'LOGIN',\n      payload: {\n        user\n      }\n    });\n  };\n\n  const register = async (email, password, firstName, lastName) => {\n    const response = await axios.post('/api/account/register', {\n      email,\n      password,\n      firstName,\n      lastName\n    });\n    const {\n      accessToken,\n      user\n    } = response.data;\n    window.localStorage.setItem('accessToken', accessToken);\n    dispatch({\n      type: 'REGISTER',\n      payload: {\n        user\n      }\n    });\n  };\n\n  const logout = async () => {\n    setSession(null);\n    dispatch({\n      type: 'LOGOUT'\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: { ...state,\n      method: 'jwt',\n      login,\n      logout,\n      register\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 151,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AuthProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n\n_c = AuthProvider;\nexport { AuthContext, AuthProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["D:/React_JS/React_JS/react-scripts_JS/src/contexts/JWTContext.js"],"names":["createContext","useEffect","useReducer","PropTypes","axios","isValidToken","setSession","initialState","isAuthenticated","isInitialized","user","handlers","INITIALIZE","state","action","payload","LOGIN","LOGOUT","REGISTER","reducer","type","AuthContext","method","login","Promise","resolve","logout","register","AuthProvider","propTypes","children","node","dispatch","initialize","accessToken","window","localStorage","getItem","response","get","data","err","console","error","email","password","post","firstName","lastName","setItem"],"mappings":"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","sourcesContent":["import { createContext, useEffect, useReducer } from 'react';\r\nimport PropTypes from 'prop-types';\r\n// utils\r\nimport axios from '../utils/axios';\r\nimport { isValidToken, setSession } from '../utils/jwt';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst initialState = {\r\n  isAuthenticated: false,\r\n  isInitialized: false,\r\n  user: null,\r\n};\r\n\r\nconst handlers = {\r\n  INITIALIZE: (state, action) => {\r\n    const { isAuthenticated, user } = action.payload;\r\n    return {\r\n      ...state,\r\n      isAuthenticated,\r\n      isInitialized: true,\r\n      user,\r\n    };\r\n  },\r\n  LOGIN: (state, action) => {\r\n    const { user } = action.payload;\r\n\r\n    return {\r\n      ...state,\r\n      isAuthenticated: true,\r\n      user,\r\n    };\r\n  },\r\n  LOGOUT: (state) => ({\r\n    ...state,\r\n    isAuthenticated: false,\r\n    user: null,\r\n  }),\r\n  REGISTER: (state, action) => {\r\n    const { user } = action.payload;\r\n\r\n    return {\r\n      ...state,\r\n      isAuthenticated: true,\r\n      user,\r\n    };\r\n  },\r\n};\r\n\r\nconst reducer = (state, action) => (handlers[action.type] ? handlers[action.type](state, action) : state);\r\n\r\nconst AuthContext = createContext({\r\n  ...initialState,\r\n  method: 'jwt',\r\n  login: () => Promise.resolve(),\r\n  logout: () => Promise.resolve(),\r\n  register: () => Promise.resolve(),\r\n});\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nAuthProvider.propTypes = {\r\n  children: PropTypes.node,\r\n};\r\n\r\nfunction AuthProvider({ children }) {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  useEffect(() => {\r\n    const initialize = async () => {\r\n      try {\r\n        const accessToken = window.localStorage.getItem('accessToken');\r\n\r\n        if (accessToken && isValidToken(accessToken)) {\r\n          setSession(accessToken);\r\n\r\n          const response = await axios.get('/api/account/my-account');\r\n          const { user } = response.data;\r\n\r\n          dispatch({\r\n            type: 'INITIALIZE',\r\n            payload: {\r\n              isAuthenticated: true,\r\n              user,\r\n            },\r\n          });\r\n        } else {\r\n          dispatch({\r\n            type: 'INITIALIZE',\r\n            payload: {\r\n              isAuthenticated: false,\r\n              user: null,\r\n            },\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        dispatch({\r\n          type: 'INITIALIZE',\r\n          payload: {\r\n            isAuthenticated: false,\r\n            user: null,\r\n          },\r\n        });\r\n      }\r\n    };\r\n\r\n    initialize();\r\n  }, []);\r\n\r\n  const login = async (email, password) => {\r\n    const response = await axios.post('/api/account/login', {\r\n      email,\r\n      password,\r\n    });\r\n    const { accessToken, user } = response.data;\r\n\r\n    setSession(accessToken);\r\n    dispatch({\r\n      type: 'LOGIN',\r\n      payload: {\r\n        user,\r\n      },\r\n    });\r\n  };\r\n\r\n  const register = async (email, password, firstName, lastName) => {\r\n    const response = await axios.post('/api/account/register', {\r\n      email,\r\n      password,\r\n      firstName,\r\n      lastName,\r\n    });\r\n    const { accessToken, user } = response.data;\r\n\r\n    window.localStorage.setItem('accessToken', accessToken);\r\n    dispatch({\r\n      type: 'REGISTER',\r\n      payload: {\r\n        user,\r\n      },\r\n    });\r\n  };\r\n\r\n  const logout = async () => {\r\n    setSession(null);\r\n    dispatch({ type: 'LOGOUT' });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        ...state,\r\n        method: 'jwt',\r\n        login,\r\n        logout,\r\n        register,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport { AuthContext, AuthProvider };\r\n"]},"metadata":{},"sourceType":"module"}