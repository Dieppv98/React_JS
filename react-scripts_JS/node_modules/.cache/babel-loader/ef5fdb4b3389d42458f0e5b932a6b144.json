{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport sum from 'lodash/sum';\nimport uniqBy from 'lodash/uniqBy'; // utils\n\nimport axios from '../../utils/axios'; //\n\nimport { dispatch } from '../store'; // ----------------------------------------------------------------------\n\nconst initialState = {\n  isLoading: false,\n  error: null,\n  products: [],\n  product: null,\n  sortBy: null,\n  filters: {\n    gender: [],\n    category: 'All',\n    colors: [],\n    priceRange: '',\n    rating: ''\n  },\n  checkout: {\n    activeStep: 0,\n    cart: [],\n    subtotal: 0,\n    total: 0,\n    discount: 0,\n    shipping: 0,\n    billing: null\n  }\n};\nconst slice = createSlice({\n  name: 'product',\n  initialState,\n  reducers: {\n    // START LOADING\n    startLoading(state) {\n      state.isLoading = true;\n    },\n\n    // HAS ERROR\n    hasError(state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n\n    // GET PRODUCTS\n    getProductsSuccess(state, action) {\n      state.isLoading = false;\n      state.products = action.payload;\n    },\n\n    // GET PRODUCT\n    getProductSuccess(state, action) {\n      state.isLoading = false;\n      state.product = action.payload;\n    },\n\n    //  SORT & FILTER PRODUCTS\n    sortByProducts(state, action) {\n      state.sortBy = action.payload;\n    },\n\n    filterProducts(state, action) {\n      state.filters.gender = action.payload.gender;\n      state.filters.category = action.payload.category;\n      state.filters.colors = action.payload.colors;\n      state.filters.priceRange = action.payload.priceRange;\n      state.filters.rating = action.payload.rating;\n    },\n\n    // CHECKOUT\n    getCart(state, action) {\n      const cart = action.payload;\n      const subtotal = sum(cart.map(cartItem => cartItem.price * cartItem.quantity));\n      const discount = cart.length === 0 ? 0 : state.checkout.discount;\n      const shipping = cart.length === 0 ? 0 : state.checkout.shipping;\n      const billing = cart.length === 0 ? null : state.checkout.billing;\n      state.checkout.cart = cart;\n      state.checkout.discount = discount;\n      state.checkout.shipping = shipping;\n      state.checkout.billing = billing;\n      state.checkout.subtotal = subtotal;\n      state.checkout.total = subtotal - discount;\n    },\n\n    addCart(state, action) {\n      const product = action.payload;\n      const isEmptyCart = state.checkout.cart.length === 0;\n\n      if (isEmptyCart) {\n        state.checkout.cart = [...state.checkout.cart, product];\n      } else {\n        state.checkout.cart = state.checkout.cart.map(_product => {\n          const isExisted = _product.id === product.id;\n\n          if (isExisted) {\n            return { ..._product,\n              quantity: _product.quantity + 1\n            };\n          }\n\n          return _product;\n        });\n      }\n\n      state.checkout.cart = uniqBy([...state.checkout.cart, product], 'id');\n    },\n\n    deleteCart(state, action) {\n      const updateCart = state.checkout.cart.filter(item => item.id !== action.payload);\n      state.checkout.cart = updateCart;\n    },\n\n    resetCart(state) {\n      state.checkout.activeStep = 0;\n      state.checkout.cart = [];\n      state.checkout.total = 0;\n      state.checkout.subtotal = 0;\n      state.checkout.discount = 0;\n      state.checkout.shipping = 0;\n      state.checkout.billing = null;\n    },\n\n    onBackStep(state) {\n      state.checkout.activeStep -= 1;\n    },\n\n    onNextStep(state) {\n      state.checkout.activeStep += 1;\n    },\n\n    onGotoStep(state, action) {\n      const goToStep = action.payload;\n      state.checkout.activeStep = goToStep;\n    },\n\n    increaseQuantity(state, action) {\n      const productId = action.payload;\n      const updateCart = state.checkout.cart.map(product => {\n        if (product.id === productId) {\n          return { ...product,\n            quantity: product.quantity + 1\n          };\n        }\n\n        return product;\n      });\n      state.checkout.cart = updateCart;\n    },\n\n    decreaseQuantity(state, action) {\n      const productId = action.payload;\n      const updateCart = state.checkout.cart.map(product => {\n        if (product.id === productId) {\n          return { ...product,\n            quantity: product.quantity - 1\n          };\n        }\n\n        return product;\n      });\n      state.checkout.cart = updateCart;\n    },\n\n    createBilling(state, action) {\n      state.checkout.billing = action.payload;\n    },\n\n    applyDiscount(state, action) {\n      const discount = action.payload;\n      state.checkout.discount = discount;\n      state.checkout.total = state.checkout.subtotal - discount;\n    },\n\n    applyShipping(state, action) {\n      const shipping = action.payload;\n      state.checkout.shipping = shipping;\n      state.checkout.total = state.checkout.subtotal - state.checkout.discount + shipping;\n    }\n\n  }\n}); // Reducer\n\nexport default slice.reducer; // Actions\n\nexport const {\n  getCart,\n  addCart,\n  resetCart,\n  onGotoStep,\n  onBackStep,\n  onNextStep,\n  deleteCart,\n  createBilling,\n  applyShipping,\n  applyDiscount,\n  increaseQuantity,\n  decreaseQuantity,\n  sortByProducts,\n  filterProducts\n} = slice.actions; // ----------------------------------------------------------------------\n\nexport function getProducts() {\n  return async () => {\n    dispatch(slice.actions.startLoading());\n\n    try {\n      const response = await axios.get('/api/products');\n      dispatch(slice.actions.getProductsSuccess(response.data.products));\n    } catch (error) {\n      dispatch(slice.actions.hasError(error));\n    }\n  };\n} // ----------------------------------------------------------------------\n\nexport function getProduct(name) {\n  return async () => {\n    dispatch(slice.actions.startLoading());\n\n    try {\n      const response = await axios.get('/api/products/product', {\n        params: {\n          name\n        }\n      });\n      dispatch(slice.actions.getProductSuccess(response.data.product));\n    } catch (error) {\n      console.error(error);\n      dispatch(slice.actions.hasError(error));\n    }\n  };\n}","map":{"version":3,"sources":["D:/React_JS/React_JS/react-scripts_JS/src/redux/slices/product.js"],"names":["createSlice","sum","uniqBy","axios","dispatch","initialState","isLoading","error","products","product","sortBy","filters","gender","category","colors","priceRange","rating","checkout","activeStep","cart","subtotal","total","discount","shipping","billing","slice","name","reducers","startLoading","state","hasError","action","payload","getProductsSuccess","getProductSuccess","sortByProducts","filterProducts","getCart","map","cartItem","price","quantity","length","addCart","isEmptyCart","_product","isExisted","id","deleteCart","updateCart","filter","item","resetCart","onBackStep","onNextStep","onGotoStep","goToStep","increaseQuantity","productId","decreaseQuantity","createBilling","applyDiscount","applyShipping","reducer","actions","getProducts","response","get","data","getProduct","params","console"],"mappings":"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","sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\r\nimport sum from 'lodash/sum';\r\nimport uniqBy from 'lodash/uniqBy';\r\n// utils\r\nimport axios from '../../utils/axios';\r\n//\r\nimport { dispatch } from '../store';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst initialState = {\r\n  isLoading: false,\r\n  error: null,\r\n  products: [],\r\n  product: null,\r\n  sortBy: null,\r\n  filters: {\r\n    gender: [],\r\n    category: 'All',\r\n    colors: [],\r\n    priceRange: '',\r\n    rating: '',\r\n  },\r\n  checkout: {\r\n    activeStep: 0,\r\n    cart: [],\r\n    subtotal: 0,\r\n    total: 0,\r\n    discount: 0,\r\n    shipping: 0,\r\n    billing: null,\r\n  },\r\n};\r\n\r\nconst slice = createSlice({\r\n  name: 'product',\r\n  initialState,\r\n  reducers: {\r\n    // START LOADING\r\n    startLoading(state) {\r\n      state.isLoading = true;\r\n    },\r\n\r\n    // HAS ERROR\r\n    hasError(state, action) {\r\n      state.isLoading = false;\r\n      state.error = action.payload;\r\n    },\r\n\r\n    // GET PRODUCTS\r\n    getProductsSuccess(state, action) {\r\n      state.isLoading = false;\r\n      state.products = action.payload;\r\n    },\r\n\r\n    // GET PRODUCT\r\n    getProductSuccess(state, action) {\r\n      state.isLoading = false;\r\n      state.product = action.payload;\r\n    },\r\n\r\n    //  SORT & FILTER PRODUCTS\r\n    sortByProducts(state, action) {\r\n      state.sortBy = action.payload;\r\n    },\r\n\r\n    filterProducts(state, action) {\r\n      state.filters.gender = action.payload.gender;\r\n      state.filters.category = action.payload.category;\r\n      state.filters.colors = action.payload.colors;\r\n      state.filters.priceRange = action.payload.priceRange;\r\n      state.filters.rating = action.payload.rating;\r\n    },\r\n\r\n    // CHECKOUT\r\n    getCart(state, action) {\r\n      const cart = action.payload;\r\n\r\n      const subtotal = sum(cart.map((cartItem) => cartItem.price * cartItem.quantity));\r\n      const discount = cart.length === 0 ? 0 : state.checkout.discount;\r\n      const shipping = cart.length === 0 ? 0 : state.checkout.shipping;\r\n      const billing = cart.length === 0 ? null : state.checkout.billing;\r\n\r\n      state.checkout.cart = cart;\r\n      state.checkout.discount = discount;\r\n      state.checkout.shipping = shipping;\r\n      state.checkout.billing = billing;\r\n      state.checkout.subtotal = subtotal;\r\n      state.checkout.total = subtotal - discount;\r\n    },\r\n\r\n    addCart(state, action) {\r\n      const product = action.payload;\r\n      const isEmptyCart = state.checkout.cart.length === 0;\r\n\r\n      if (isEmptyCart) {\r\n        state.checkout.cart = [...state.checkout.cart, product];\r\n      } else {\r\n        state.checkout.cart = state.checkout.cart.map((_product) => {\r\n          const isExisted = _product.id === product.id;\r\n          if (isExisted) {\r\n            return {\r\n              ..._product,\r\n              quantity: _product.quantity + 1,\r\n            };\r\n          }\r\n          return _product;\r\n        });\r\n      }\r\n      state.checkout.cart = uniqBy([...state.checkout.cart, product], 'id');\r\n    },\r\n\r\n    deleteCart(state, action) {\r\n      const updateCart = state.checkout.cart.filter((item) => item.id !== action.payload);\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    resetCart(state) {\r\n      state.checkout.activeStep = 0;\r\n      state.checkout.cart = [];\r\n      state.checkout.total = 0;\r\n      state.checkout.subtotal = 0;\r\n      state.checkout.discount = 0;\r\n      state.checkout.shipping = 0;\r\n      state.checkout.billing = null;\r\n    },\r\n\r\n    onBackStep(state) {\r\n      state.checkout.activeStep -= 1;\r\n    },\r\n\r\n    onNextStep(state) {\r\n      state.checkout.activeStep += 1;\r\n    },\r\n\r\n    onGotoStep(state, action) {\r\n      const goToStep = action.payload;\r\n      state.checkout.activeStep = goToStep;\r\n    },\r\n\r\n    increaseQuantity(state, action) {\r\n      const productId = action.payload;\r\n      const updateCart = state.checkout.cart.map((product) => {\r\n        if (product.id === productId) {\r\n          return {\r\n            ...product,\r\n            quantity: product.quantity + 1,\r\n          };\r\n        }\r\n        return product;\r\n      });\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    decreaseQuantity(state, action) {\r\n      const productId = action.payload;\r\n      const updateCart = state.checkout.cart.map((product) => {\r\n        if (product.id === productId) {\r\n          return {\r\n            ...product,\r\n            quantity: product.quantity - 1,\r\n          };\r\n        }\r\n        return product;\r\n      });\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    createBilling(state, action) {\r\n      state.checkout.billing = action.payload;\r\n    },\r\n\r\n    applyDiscount(state, action) {\r\n      const discount = action.payload;\r\n      state.checkout.discount = discount;\r\n      state.checkout.total = state.checkout.subtotal - discount;\r\n    },\r\n\r\n    applyShipping(state, action) {\r\n      const shipping = action.payload;\r\n      state.checkout.shipping = shipping;\r\n      state.checkout.total = state.checkout.subtotal - state.checkout.discount + shipping;\r\n    },\r\n  },\r\n});\r\n\r\n// Reducer\r\nexport default slice.reducer;\r\n\r\n// Actions\r\nexport const {\r\n  getCart,\r\n  addCart,\r\n  resetCart,\r\n  onGotoStep,\r\n  onBackStep,\r\n  onNextStep,\r\n  deleteCart,\r\n  createBilling,\r\n  applyShipping,\r\n  applyDiscount,\r\n  increaseQuantity,\r\n  decreaseQuantity,\r\n  sortByProducts,\r\n  filterProducts,\r\n} = slice.actions;\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport function getProducts() {\r\n  return async () => {\r\n    dispatch(slice.actions.startLoading());\r\n    try {\r\n      const response = await axios.get('/api/products');\r\n      dispatch(slice.actions.getProductsSuccess(response.data.products));\r\n    } catch (error) {\r\n      dispatch(slice.actions.hasError(error));\r\n    }\r\n  };\r\n}\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport function getProduct(name) {\r\n  return async () => {\r\n    dispatch(slice.actions.startLoading());\r\n    try {\r\n      const response = await axios.get('/api/products/product', {\r\n        params: { name },\r\n      });\r\n      dispatch(slice.actions.getProductSuccess(response.data.product));\r\n    } catch (error) {\r\n      console.error(error);\r\n      dispatch(slice.actions.hasError(error));\r\n    }\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}